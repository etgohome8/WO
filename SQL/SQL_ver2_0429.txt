CREATE TABLE ADMINS (
  A_SEQ SERIAL4 NOT NULL,
  A_ID VARCHAR(20) PRIMARY KEY NOT NULL,
  A_PASSWORD VARCHAR(30) NOT NULL,
  A_NAME VARCHAR(30) NOT NULL
);

CREATE TABLE COUPON_TEMPLATE (
  CT_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  CT_NAME VARCHAR(50) NOT NULL,
  CT_TYPE BOOL NOT NULL DEFAULT FALSE,
  CT_NUMBER VARCHAR(20) NOT NULL,
  CT_STARTDATE DATE NOT NULL,
  CT_ENDDATE DATE NOT NULL,
  CT_DISCOUNT_TYPE BOOL NOT NULL DEFAULT FALSE,
  CT_DISCOUNT INT4 NOT NULL DEFAULT 0
);


CREATE TABLE COUPON (
  C_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  CT_CODE VARCHAR(20) NOT NULL,
  C_NUMBER VARCHAR(20) NOT NULL,
  C_STARTDATE DATE NOT NULL,
  C_ENDDATE DATE NOT NULL,
  C_USEABLE BOOL NOT NULL DEFAULT FALSE,
  C_USEDDATE timestamp DEFAULT NULL,
  U_ID VARCHAR(20) NOT NULL
);


CREATE TABLE EVENT_BOARD (
  E_SEQ SERIAL4 NOT NULL,
  E_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  E_TITLE VARCHAR(100) NOT NULL,
  E_THUMBNAIL_IMAGE VARCHAR(255) NOT NULL,
  E_COMTENT_IMAGE VARCHAR(255) NOT NULL,
  E_URL VARCHAR(1000) NOT NULL,
  E_REGTDATE timestamp NOT NULL,
  E_STARTDATE timestamp NOT NULL,
  E_ENDDATE timestamp NOT NULL
);

CREATE TABLE FAQ (
  FAC_SEQ SERIAL4 NOT NULL,
  FAC_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  FAC_TYPE VARCHAR(20) NOT NULL,
  FAC_TITLE VARCHAR(100) NOT NULL,
  FAC_CONTENT VARCHAR(4000) NOT NULL
);

CREATE TABLE FAQ_STORE (
  FAS_SEQ SERIAL4 NOT NULL,
  FAS_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  FAS_TYPE VARCHAR(10) NOT NULL,
  FAS_TITLE VARCHAR(1000) NOT NULL,
  FAS_CONTENT VARCHAR(4000) NOT NULL
);

CREATE TABLE MENU_GROUP (
  MG_SEQ SERIAL4 NOT NULL,
  MG_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  MG_NAME VARCHAR(50) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL
);

CREATE TABLE OPTION_GROUP (
  OG_SEQ SERIAL4 NOT NULL,
  OG_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  OG_NAME VARCHAR(50) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL
);

CREATE TABLE MENU_OPTION (
  OP_SEQ SERIAL4 NOT NULL,
  OP_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  OG_CODE VARCHAR(50) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  OP_SEL1 BOOL NOT NULL DEFAULT FALSE,
  OP_SEL2 VARCHAR(1000) NOT NULL,
  OP_SEL3 VARCHAR(1000) NOT NULL,
  OP_OOS BOOL NOT NULL DEFAULT FALSE
);

CREATE TABLE NOTICE_BOARD (
  N_SEQ SERIAL4 NOT NULL,
  N_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  N_TITLE VARCHAR(100) NOT NULL,
  N_CONTENT TEXT NOT NULL,
  N_REGDATE timestamp NOT NULL,
  N_FIX BOOL NOT NULL,
  N_TYPE VARCHAR(20) NOT NULL,
  N_PIC_URL VARCHAR(255) NOT NULL
);

CREATE TABLE STORE_FORM (
  SF_SEQ SERIAL4 NOT NULL,
  SF_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  SF_NAME VARCHAR(100) NOT NULL,
  SF_REG_DATE timestamp NOT NULL,
  SF_LOC VARCHAR(20),
  SF_ZIPCODE VARCHAR(20) NOT NULL,
  SF_ADDRESS VARCHAR(255) NOT NULL,
  SF_ADDR_ROAD VARCHAR(255) NOT NULL,
  SF_ADDR_DETAIL VARCHAR(255),
  SF_TEL VARCHAR(20) NOT NULL,
  SF_PARKING_ABLE BOOL NOT NULL DEFAULT FALSE,
  SF_DUE_TIME VARCHAR(20),
  SF_HOLIDAY_FIX VARCHAR(20),
  SF_HOLIDAY_IMSI VARCHAR(20),
  SF_OPEN VARCHAR(40) NOT NULL,
  SF_CLOSE VARCHAR(40) NOT NULL,
  SF_REFERINFO VARCHAR(4000) NOT NULL,
  SF_MAP_IMAGE VARCHAR(255),
  SF_DIRECTIONS VARCHAR(1000),
  SF_IMAGE VARCHAR(255) NOT NULL DEFAULT 'HTTPS://WALKINGORDER.S3.AP-NORTHEAST-2.AMAZONAWS.COM/CAFE_IMAGES/NO-IMAGE-CAFE.PNG',
  SF_STATUS BOOL NOT NULL DEFAULT TRUE,
  SF_USESTORE BOOL NOT NULL DEFAULT FALSE,
  SF_EMAIL VARCHAR(100) NOT NULL DEFAULT 'NO_EMAIL_T_T',
  SF_ACC_NO VARCHAR(20) NOT NULL,
  SF_BANKBOOK_IMAGE VARCHAR(255) NOT NULL,
  SF_BUSINESS_REGISTRATION_IMAGE VARCHAR(255) NOT NULL
);

CREATE TABLE STORE_INFO (
  SI_SEQ SERIAL4 NOT NULL,
  SI_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  SI_NAME VARCHAR(100) NOT NULL,
  SI_REG_DATE timestamp NOT NULL,
  SI_LOC VARCHAR(20),
  SI_ZIPCODE VARCHAR(20) NOT NULL,
  SI_ADDRESS VARCHAR(255) NOT NULL,
  SI_ADDR_ROAD VARCHAR(255) NOT NULL,
  SI_ADDR_DETAIL VARCHAR(255),
  SI_TEL VARCHAR(20) NOT NULL,
  SI_PARKING_ABLE BOOL NOT NULL DEFAULT FALSE,
  SI_DUE_TIME VARCHAR(20),
  SI_HOLIDAY_FIX VARCHAR(20),
  SI_HOLIDAY_IMSI VARCHAR(20),
  SI_OPEN VARCHAR(40) NOT NULL,
  SI_CLOSE VARCHAR(40) NOT NULL,
  SI_REFERINFO VARCHAR(4000) NOT NULL,
  SI_MAP_IMAGE VARCHAR(255),
  SI_DIRECTIONS VARCHAR(1000),
  SI_IMAGE VARCHAR(255) NOT NULL DEFAULT 'HTTPS://WALKINGORDER.S3.AP-NORTHEAST-2.AMAZONAWS.COM/CAFE_IMAGES/NO-IMAGE-CAFE.PNG',
  SI_STATUS BOOL NOT NULL DEFAULT TRUE,
  SI_USESTORE BOOL NOT NULL DEFAULT TRUE
);


CREATE TABLE STORE_ACCOUNT (
  SA_SEQ SERIAL4 NOT NULL,
  SA_ACC_NO VARCHAR(20) PRIMARY KEY NOT NULL,
  SA_PASSWORD VARCHAR(30) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  SA_BANKBOOK_IMAGE VARCHAR(255) NOT NULL,
  SA_BUSINESS_REGISTRATION_IMAGE VARCHAR(255) NOT NULL,
  SA_REGDATE timestamp NOT NULL,
  SA_STATUS BOOL NOT NULL DEFAULT TRUE
);

CREATE TABLE TERMS (
  T_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  T_TYPE VARCHAR(20) NOT NULL,
  T_TITLE VARCHAR(1000) NOT NULL,
  T_CONTENT TEXT NOT NULL,
  T_REGDATE timestamp NOT NULL,
  T_ENFDATE timestamp NOT NULL
);

CREATE TABLE USERS (
  U_SEQ SERIAL4 NOT NULL,
  U_ID VARCHAR(20) PRIMARY KEY NOT NULL,
  U_PASSWORD VARCHAR(30) NOT NULL,
  U_TYPE VARCHAR(10) NOT NULL DEFAULT 'NORMAL',
  U_NAME VARCHAR(50) NOT NULL,
  U_NICKNAME VARCHAR(50) UNIQUE NOT NULL,
  U_TEL VARCHAR(20) NOT NULL,
  U_EMAIL VARCHAR(100) NOT NULL,
  U_BIRTHDAY VARCHAR(20),
  U_SMS_ABLE BOOL NOT NULL DEFAULT FALSE,
  U_EMAIL_ABLE BOOL NOT NULL DEFAULT FALSE,
  U_POINT INT4 NOT NULL DEFAULT 0,
  U_REGDATE timestamp NOT NULL,
  U_STATUS BOOL NOT NULL DEFAULT TRUE
);

CREATE TABLE BANNER (
  B_SEQ SERIAL4 NOT NULL,
  B_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  E_CODE VARCHAR(20) NOT NULL,
  B_TITLE VARCHAR(100) NOT NULL,
  B_CLICK_URL VARCHAR(2500) NOT NULL,
  B_IMAGE VARCHAR(255) NOT NULL
);

CREATE TABLE FRANCHISE (
  F_SEQ SERIAL4 NOT NULL,
  F_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  F_NAME VARCHAR(100) NOT NULL,
  F_TEL VARCHAR(20) NOT NULL,
  F_EMAIL VARCHAR(100) NOT NULL,
  F_LOC VARCHAR(20) NOT NULL,
  F_TITLE VARCHAR(100) NOT NULL,
  F_CONTENT VARCHAR(4000) NOT NULL,
  F_REGDATE timestamp NOT NULL
);

CREATE TABLE FRANCHISE_ACCEPT (
  FA_SEQ SERIAL4 NOT NULL,
  FA_CODE VARCHAR(20) NOT NULL,
  F_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  FA_ACC VARCHAR(10) NOT NULL,
  FA_CONT_ACCEPT VARCHAR(4000) NOT NULL,
  FA_CONT_DENIAL VARCHAR(4000) NOT NULL,
  FA_CONT_RETURN VARCHAR(4000) NOT NULL
);

CREATE TABLE LIKE_STORE (
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  PRIMARY KEY (U_ID, SI_CODE)
);

CREATE TABLE MENU (
  M_SEQ SERIAL4 NOT NULL,
  M_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  M_OOS BOOL NOT NULL DEFAULT FALSE,
  M_NAME VARCHAR(50) NOT NULL,
  M_PRICE INT4 NOT NULL,
  M_IMG_FILE VARCHAR(255) NOT NULL,
  MG_CODE VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL
);

CREATE TABLE ORDERS (
  O_SEQ SERIAL4 NOT NULL,
  O_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  O_ORDER_DATE timestamp NOT NULL,
  O_COUPON_STATUS BOOL NOT NULL DEFAULT FALSE,
  C_CODE VARCHAR(20) NOT NULL,
  O_POINT_STATUS BOOL NOT NULL DEFAULT FALSE,
  O_POINT VARCHAR(20),
  O_PAYMENT_LIST VARCHAR(20) NOT NULL,
  O_REQUEST VARCHAR(255) NOT NULL,
  O_DISCOUNT_PRICE INT4 NOT NULL,
  O_TOTAL_PRICE INT4 NOT NULL,
  O_ORDER_STATE VARCHAR(1000) NOT NULL
);

CREATE TABLE QNA (
  QA_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  QA_TYPE VARCHAR(10) NOT NULL,
  QA_TITLE VARCHAR(1000) NOT NULL,
  QA_TYPE_ANS BOOL NOT NULL,
  QA_CONTENT_Q VARCHAR(4000) NOT NULL,
  QA_CONTENT_A VARCHAR(4000) NOT NULL,
  QA_DATE_Q timestamp NOT NULL,
  QA_DATE_A timestamp NOT NULL
);

CREATE TABLE USER_REVIEW (
  UR_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  UR_REGDATE timestamp NOT NULL,
  UR_STAR FLOAT8 NOT NULL,
  UR_PIC_URL VARCHAR(255),
  UR_CONTENT VARCHAR(4000),
  O_CODE VARCHAR(20),
  UR_OPEN BOOL NOT NULL DEFAULT FALSE,
  UR_ANS VARCHAR(4000)
);

CREATE TABLE BASKET (
  B_SEQ SERIAL4 NOT NULL,
  B_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  M_CODE VARCHAR(20) NOT NULL,
  B_QUANTITY INT4 NOT NULL,
  OB_CODE VARCHAR(20) NOT NULL,
  B_TOTAL_PRICE INT4 NOT NULL
);

CREATE TABLE OPTION_BASKET (
  OB_SEQ SERIAL4 NOT NULL,
  OB_CODE VARCHAR(20) PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  SI_CODE VARCHAR(20) NOT NULL,
  M_CODE VARCHAR(20) NOT NULL,
  OP_CODE VARCHAR(20) NOT NULL
);

CREATE TABLE SMS_MESSAGE (
  SMS_SEQ SERIAL4 PRIMARY KEY NOT NULL,
  SMS_TONUM VARCHAR(20) NOT NULL,
  SMS_TYPE VARCHAR(10) NOT NULL DEFAULT 'SMS',
  ISADVERTISE BOOLEAN NOT NULL DEFAULT FALSE,
  SMS_TEXT VARCHAR(1000) NOT NULL,
  SMS_SIZE INT,
  SMS_SENDTIME TIMESTAMP NOT NULL,
  SMS_RESULT BOOLEAN NOT NULL DEFAULT FALSE
);

CREATE TABLE POINT (
  PT_SEQ SERIAL PRIMARY KEY NOT NULL,
  U_ID VARCHAR(20) NOT NULL,
  PT_REGDATE TIMESTAMP NOT NULL,
  PT_TYPE VARCHAR(10) NOT NULL DEFAULT '적립',
  PT_DESCRIPTION VARCHAR(100) NOT NULL,
  PT_HANDLER VARCHAR(20) NOT NULL DEFAULT '시스템'
);


ALTER TABLE LIKE_STORE ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID);

ALTER TABLE ORDERS ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID);

ALTER TABLE QNA ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID);

ALTER TABLE USER_REVIEW ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID);

ALTER TABLE COUPON ADD FOREIGN KEY (CT_CODE) REFERENCES COUPON_TEMPLATE (CT_CODE) ON DELETE CASCADE;

ALTER TABLE COUPON ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID);

ALTER TABLE USER_REVIEW ADD FOREIGN KEY (O_CODE) REFERENCES ORDERS (O_CODE);

ALTER TABLE MENU ADD FOREIGN KEY (MG_CODE) REFERENCES MENU_GROUP (MG_CODE);

ALTER TABLE OPTION_BASKET ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID) ON DELETE CASCADE;

ALTER TABLE ORDERS ADD FOREIGN KEY (C_CODE) REFERENCES COUPON (C_CODE);

ALTER TABLE OPTION_BASKET ADD FOREIGN KEY (M_CODE) REFERENCES MENU (M_CODE);

ALTER TABLE OPTION_BASKET ADD FOREIGN KEY (OP_CODE) REFERENCES MENU_OPTION (OP_CODE);

ALTER TABLE MENU_OPTION ADD FOREIGN KEY (OG_CODE) REFERENCES OPTION_GROUP (OG_CODE) ON DELETE CASCADE;

ALTER TABLE STORE_ACCOUNT ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE OPTION_GROUP ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE COUPON_TEMPLATE ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE USER_REVIEW ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE LIKE_STORE ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE ORDERS ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE);

ALTER TABLE MENU ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE MENU_OPTION ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE OPTION_BASKET ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE);

ALTER TABLE BASKET ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID) ON DELETE CASCADE;

ALTER TABLE BASKET ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE);

ALTER TABLE BASKET ADD FOREIGN KEY (M_CODE) REFERENCES MENU (M_CODE);

ALTER TABLE BASKET ADD FOREIGN KEY (OB_CODE) REFERENCES OPTION_BASKET (OB_CODE);

ALTER TABLE FRANCHISE_ACCEPT ADD FOREIGN KEY (F_CODE) REFERENCES FRANCHISE (F_CODE) ON DELETE CASCADE;

ALTER TABLE BANNER ADD FOREIGN KEY (E_CODE) REFERENCES EVENT_BOARD (E_CODE) ON DELETE CASCADE;

ALTER TABLE QNA ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE MENU_GROUP ADD FOREIGN KEY (SI_CODE) REFERENCES STORE_INFO (SI_CODE) ON DELETE CASCADE;

ALTER TABLE POINT ADD FOREIGN KEY (U_ID) REFERENCES USERS (U_ID) ON DELETE CASCADE;
